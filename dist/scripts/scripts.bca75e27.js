!function(){"use strict";angular.module("exchange",["appController","mainService","ui-notification"]).constant("config",{appName:"exchange",apiUrl:"https://exchange1704.herokuapp.com/api/",apikey:"ca5f41e1722a406d90028f4ae6e2de15",contentTypeConfig:{headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}}}).config(["NotificationProvider","$httpProvider",function(a,b){a.setOptions({delay:1e4,startTop:20,startRight:10,verticalSpacing:20,horizontalSpacing:20,positionX:"left",positionY:"bottom"}),b.interceptors.push("AuthInterceptor")}])}(),function(){"use strict";angular.module("appController",[]).controller("MainCtrl",["$scope","$q","MainService","Notification","$timeout",function(a,b,c,d,e){var f=this;f.loading=!0,f.unitOfCurr=1,f.currentDate=new Date;var g=function(a,b){if(200==a[0].status){var c=a[0].data,g=a[1].data,h=[];for(var i in c.rates)h.push({currencyName:g[i],code:i,rate:c.rates[i]});e(function(){f.exchangeList=h},0),f.exchangeList=h,f.currencies=g,f.loading=!1,b&&(f.updating=!1)}else{f.loading=!1;var j=a[0].data.description||"500 error,will be fixed soon";d.error(j)}};f.changeSelectedItem=function(){f.calculateExchange()},b.all([c.getLatestExchange(),c.getCurrencies()]).then(function(a){g(a)}),f.oldExchange=function(){f.updating=!0;var a=f.currentDate,d=a.getFullYear().toString(),e=a.getDate().toString(),h=+a.getMonth()+1;10>h&&(h="0"+h),10>e&&(e="0"+e);var i=d.concat("-").concat(h).concat("-").concat(e);b.all([c.getHistoryExchange(i),c.getCurrencies()]).then(function(a){g(a,!0)})},f.calculateExchange=function(){if(f.fromCurrency&&f.toCurrency){var a=1/+f.fromCurrency.rate,b=a*+f.toCurrency.rate*+f.unitOfCurr;f.result=(+b.toFixed(7)).toString()}}}])}(),function(){"use strict";angular.module("mainService",[]).factory("MainService",["$http","config",function(a,b){var c={};return c.getLatestExchange=function(){return a.get(b.apiUrl.concat("latest"))},c.getCurrencies=function(){return a.get(b.apiUrl.concat("currencies"))},c.getHistoryExchange=function(c){return a.get(b.apiUrl.concat("history?date="+c))},c}]).factory("AuthInterceptor",["$q","$location","config","$window",function(a,b,c,d){var e={};return e.request=function(a){return c.apikey&&(a.headers.apikey=c.apikey),a},e.responseError=function(c){return 403==c.status&&(console.log("unauthorized error"),d.location="/403.html",a.reject(c)),401==c.status?(d.location="/403.html",a.reject(c)):-1==c.status?a.reject(c):500==c.status?(b.path("/500.html"),a.reject(c)):void 0},e}])}();